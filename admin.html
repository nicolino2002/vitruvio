<?php
   include('session.php');
?>

<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <!--<link href="./css/signin.css" rel="stylesheet">-->
    <title>InfoWaste Admin Page (ver. 1.0)</title>


    <style media="screen">
      .mainform
          {
            width:90%;
            height:20%;
            margin-left:5%;
            border-color: #044A92;
          }
      .form1 {
              width:30%;
              height: 300px;
              padding:2px 5px;
              border: 3px solid #044A92;
              display: inline-block;
              float: left
              text-align:center;
              margin:8px;
              margin-right:30px;
          }
      .form2 {
              width:30%;
              height: 320px;
              padding:2px 5px;
              border: 3px solid #044A92;
              display: inline-block;
              float: left
              text-align:center;
              margin:8px;
              margin-right:30px;
      .form3 {
              width:30%;
              height: 400px;
              padding:2px 5px;
              border: 3px solid #044A92;
              display: inline-block;
              float: left
              text-align:center;
              margin:8px;
              margin-right:30px;
          }
          .campo
          {
            padding:2px 2px;
            height:20px;
            width:250px;
            v-align:middle;
          }
          .send
          {
            height:60px;
            padding:10px;
            v-align:middle;
          }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>
  <body>


    <br>
    <p style="font-size: x-large; color: #044A92">
     <img src="./img/iw.jpg" width="50" height="50" style="margin-left: 5%"> InfoWaste
   </p>
    <div class="mainform">
      <div class="form1">
        <table class="table table-sm">
          <tr>
            <th class="campo" colspan="2">Seleziona Comune</th>
          </tr>
          <tr>
            <th class="campo">Campo</th>
            <th class="campo">Valore</th>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Regione: </label>
            </td>
            <td class="campo">
              <select id="reg" class="select" name="reg" onchange="get_prov(this); " required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Provincia: </label>
            </td>
            <td class="campo">
               <select id="prov" class="select" name="prov" onchange="get_town(this)" disabled="true"; required autofocus>
                 <option value="">Please Select</option>
               </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Comune: </label>
            </td>
            <td class="campo">
               <select id="town" class="select" name="town" onchange="get_users(this);get_aut_users(this);get_del_users(this);new_user();" disabled="true"; required autofocus>
                 <option value="">Please Select</option>
               </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Utenti Attivi: </label>
            </td>
            <td class="campo">
              <a id="usersbytown" type="text" name="usersbytown" style="font-weight: bold; color: #044A92;" value="NULL">NULL</a>
            </td>
          </tr>
        </table>
      </div>
      <div class="form1" hidden>
        <table class="table table-sm">
          <tr>
            <th class="campo" colspan="2">Abilita Nuovo Comune</th>
          </tr>
          <tr>
            <th class="campo">Campo</th>
            <th class="campo">Valore</th>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Regione: </label>
            </td>
            <td class="campo">
              <select id="reg" class="select" name="reg" onchange="get_prov(this); " required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Provincia: </label>
            </td>
            <td class="campo">
               <select id="prov" class="select" name="prov" onchange="get_town(this)" disabled="true"; required autofocus>
                 <option value="">Please Select</option>
               </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Comune: </label>
            </td>
            <td class="campo">
               <select id="town" class="select" name="town" onchange="get_users(this);get_aut_users(this);get_del_users(this)" disabled="true"; required autofocus>
                 <option value="">Please Select</option>
               </select>
            </td>
          </tr>
          <tr>
            <td class="campo" colspan="2">
             <button class="w-100 btn btn-lg btn-primary" style="background-color: #044A92" type="submit">Nuovo Comune</button>
            </td>
          </tr>
        </table>
      </div>
	  <br>
      <form class="form2" action="./php/upd_aut_user.php" method = "post">
        <table>
          <tr>
            <th class="campo" colspan="2">Autorizza Utente</th>
          </tr>
          <tr>
            <th class="campo">Campo</th>
            <th class="campo">Valore</th>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Account: </label>
            </td>
            <td class="campo">
              <select id="aut_users" class="select" name="aut_users" onchange="get_aut_user(this)" required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Nome: </label>
            </td>
            <td class="campo">
              <label class="text-capitalize" id="aut_name" name = "aut_name">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Cognome: </label>
            </td>
            <td class="campo">
              <label class="text-capitalize" id="aut_surname" name = "aut_surname">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Data Richiesta: </label>
            </td>
            <td class="campo">
              <label id="aut_req_date" name = "aut_req_date">NULL</label>
            </td>
          </tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Tipo di account: </label>
            </td>
            <td class="campo">
              <select class="select" id="aut_role" name="aut_role" required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Ruolo: </label>
            </td>
            <td class="campo">
              <label id="aut_title" name="aut_title">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold;">Seconda eMail (opzionale) : </label>
            </td>
            <td class="campo">
               <label class="text-capitalize" id="aut_mail2" name="aut_mail2">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold;">Invia eMail Attivazione:</label>
            </td>
            <td class="campo">
              <input class="form-check-input" type="checkbox" value="1" name = "aut_receipt" id="aut_receipt" checked="true">
            </td>
          </tr>
        </table>
        <input class="w-100 btn btn-lg btn-primary" id="aut_btn" name="aut_btn" style="background-color: #044A92" type="submit" value="Autorizza Utente" disabled>
        <!--<button class="w-100 btn btn-lg btn-primary" style="background-color: #044A92" type="submit" onclick="about.html">Autorizza Utente</button>-->
      </form>

      <form class="form2" action="./php/upd_del_user.php" method = "post">
        <table>
          <tr>
            <th class="campo" colspan="2">Cancella Utente</th>
          </tr>
          <tr>
            <th class="campo">Campo</th>
            <th class="campo">Valore</th>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Account: </label>
            </td>
            <td class="campo">
              <select id="del_users" class="select" name="del_users" onchange="get_del_user(this)" required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Nome: </label>
            </td>
            <td class="campo">
              <label class="text-capitalize" id="del_name" name = "del_name">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Cognome: </label>
            </td>
            <td class="campo">
              <label class="text-capitalize" id="del_surname" name = "del_surname">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Data Richiesta: </label>
            </td>
            <td class="campo">
              <label id="del_req_date" name = "del_req_date">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Data Attivazione: </label>
            </td>
            <td class="campo">
              <label id="del_act_date" name = "del_act_date">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Tipo di account: </label>
            </td>
            <td class="campo">
              <label id="del_role" name = "del_role">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Ruolo: </label>
            </td>
            <td class="campo">
              <label id="del_title" name="del_title">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold;">Seconda eMail (opzionale) : </label>
            </td>
            <td class="campo">
               <label class="text-capitalize" id="del_mail2" name="del_mail2">NULL</label>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold;">Invia eMail Attivazione:</label>
            </td>
            <td class="campo">
              <input class="form-check-input" type="checkbox" value="1" name = "del_receipt" id="del_receipt" checked="true">
            </td>
          </tr>
        </table>
        <input class="w-100 btn btn-lg btn-primary" id="del_btn" name="del_btn" style="background-color: #044A92" type="submit" value="Cancella Utente" disabled>
        <!--<button class="w-100 btn btn-lg btn-primary" style="background-color: #044A92" type="submit" onclick="about.html">Cancella Utente</button>-->
      </form>

      <form class="form3" id="new_user_form" action="./php/ins_new_user.php" method = "post" disabled>
        <table>
          <tr>
            <th class="campo" colspan="2">Nuovo Utente</th>
          </tr>
          <tr>
            <th class="campo">Campo</th>
            <th class="campo">Valore</th>
          </tr>
          <tr hidden>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Comune: </label>
            </td>
            <td class="campo">
              <input type="text" id="new_town" name = "new_town" class="campo" placeholder="Comune" required>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Account: </label>
            </td>
            <td class="campo">
              <input type="email" id="new_user" name = "new_user" class="campo" placeholder="Indirizzo Email" required autofocus>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Nome: </label>
            </td>
            <td class="campo">
              <input type="text" id="new_name" name = "new_name" class="campo" placeholder="Nome" required autofocus>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Cognome: </label>
            </td>
            <td class="campo">
              <input type="text" id="new_surname" name = "new_surname" class="campo" placeholder="Cognome" required autofocus>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Telefono: </label>
            </td>
            <td class="campo">
              <input type="tel" id="new_tel" name = "new_tel" class="campo" placeholder="Telefono (es. 0801234567)" pattern="[0-9]{6,15}" required autofocus>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Tipo di account: </label>
            </td>
            <td class="campo">
              <select class="select" id="new_role" name="new_role" required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Ruolo: </label>
            </td>
            <td class="campo">
              <select class="select" id="title" name="title" required autofocus>
                <option value="">Please Select</option>
              </select>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold; color: red;">Password: </label>
            </td>
            <td class="campo">
              <input type="password" id="new_pwd" name = "new_pwd" class="campo" placeholder="Password Iniziale" required autofocus>
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold;">Seconda eMail (Opzionale): </label>
            </td>
            <td class="campo">
                <input type="email" id="new_mail2" name = "new_mail2" class="campo" placeholder="Indirizzo Seconda Email">
            </td>
          </tr>
          <tr>
            <td class="campo">
              <label style="font-weight: bold;">Invia eMail Creazione.</label>
            </td>
            <td class="campo">
              <input class="form-check-input" type="checkbox" value="1" name = "new_receipt" id="new_receipt" checked="true">
            </td>
          </tr>
        </table>
        <!--<input type="hidden" name="return" value="<?php echo $_SERVER["REQUEST_URI"]; ?>"></input>-->
        <input class="w-100 btn btn-lg btn-primary" id="new_btn" name="new_btn" style="background-color: #044A92" type="submit" value="Aggiungi Utente" disabled>
        <!--<button class="w-100 btn btn-lg btn-primary" style="background-color: #044A92" type="submit" onclick="about.html">Cancella Utente</button>-->
      </form>
    </div>
    <script src="./js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="./js/jquery-3.5.1.min.js"></script>
    <script src="./js/scripts.js"></script>
    <script type="text/javascript">window.onload = get_reg();get_title();get_role();admin_form_reset();</script>
  </body>
</html>